{"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Overview","type":"heading","anchor":"Overview"},{"inlineContent":[{"text":"To start using Swift Bitcoin as a library just add it as a dependency to your package manifest.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For instructions on running a node please refer to "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Bitcoin\/documentation\/Bitcoin\/Running"},{"text":" instead.","type":"text"}]},{"anchor":"Preparation","type":"heading","text":"Preparation","level":2},{"type":"heading","anchor":"Add-the-package","level":3,"text":"Add the package"},{"inlineContent":[{"type":"text","text":"In your "},{"type":"codeVoice","code":"Package.swift"},{"text":" dependencies add the package’s URL ","type":"text"},{"code":"https:\/\/github.com\/swift-bitcoin\/swift-bitcoin","type":"codeVoice"},{"type":"text","text":"."}],"type":"paragraph"},{"type":"heading","anchor":"Import-the-framework","level":3,"text":"Import the framework"},{"inlineContent":[{"text":"To begin just import ","type":"text"},{"type":"codeVoice","code":"Bitcoin"},{"type":"text","text":"."}],"type":"paragraph"},{"code":["import Bitcoin"],"syntax":"swift","type":"codeListing"},{"text":"Mine a transaction","level":2,"type":"heading","anchor":"Mine-a-transaction"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In this example we will spin up a test Bitcoin server and use it to mine a transaction."}]},{"inlineContent":[{"type":"text","text":"Let’s start by generating a key pair and derive an address for our test."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["\/\/ Generate a secret key, corresponding public key, hash and address.","let secretKey = SecretKey()","let pubkey = secretKey.pubkey","let address = LegacyAddress(pubkey)"]},{"inlineContent":[{"type":"text","text":"Prepare the Blockchain service."}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["\/\/ Create a fresh blockchain service instance (on regtest).","let blockchain = BlockchainService()","","\/\/ Mine 100 blocks so block 1's coinbase output reaches maturity.","for _ in 0 ..< 100 {","    await blockchain.generateTo(pubkey)","}"]},{"inlineContent":[{"type":"text","text":"Prepare our transaction."}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["\/\/ Grab block 1's coinbase transaction and output.","let fundingTx = await blockchain.blocks[1].txs[0]","let prevout = fundingTx.outs[0]","","\/\/ Create a new transaction spending from the previous transaction's outpoint.","let unsignedInput = TxIn(outpoint: fundingTx.outpoint(0))","","\/\/ Specify the transaction's output. We'll leave 1000 sats on the table to tip miners. We'll re-use the origin address for simplicity.","let spendingTx = BitcoinTx(ins: [unsignedInput], outs: [address.out(100)])"]},{"inlineContent":[{"type":"text","text":"We now need to sign the transaction using our secret key."}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["let signer = TxSigner(tx: spendingTx, prevouts: [prevout])","let signedTx = signer.sign(txIn: 0, with: secretKey)"]},{"type":"paragraph","inlineContent":[{"text":"We can verify that the transaction was signed correctly.","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["\/\/ Make sure the transaction was signed correctly by verifying the scripts.","let isVerified = signedTx.verifyScript(prevouts: [prevout])","","#expect(isVerified)","\/\/ Yay! Our transaction is valid."]},{"inlineContent":[{"type":"text","text":"Now we’re ready to submit our signed transaction to the mempool."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["\/\/ Submit the signed transaction to the mempool.","try await blockchain.addTx(signedTx)","","\/\/ The mempool should now contain our transaction.","#expect(await blockchain.mempool.count == 1)"]},{"inlineContent":[{"text":"After confirming the transaction was accepted we can mine a block and get it confirmed.","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["\/\/ Let's mine another block to confirm our transaction.","","\/\/ In this case we can re-use the address we created before.","let pubkeyHash = Data(Hash160.hash(data: pubkey.data))","","\/\/ Minde to the public key hash","await blockchain.generateTo(pubkeyHash)","","\/\/ The mempool should now be empty.","#expect(await blockchain.mempool.count == 0)"]},{"type":"paragraph","inlineContent":[{"text":"Finally let’s make sure the transaction was confirmed in a block.","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["let blocks = await blockchain.blocks.count","#expect(blocks == 102)","","let lastBlock = await blockchain.blocks.last!","\/\/ Verify our transaction was confirmed in a block.","","#expect(lastBlock.txs[1] == signedTx)","\/\/ Our transaction is now confirmed in the blockchain!"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We have effectively recreated the entire transaction lifecycle."}]}]}],"hierarchy":{"paths":[["doc:\/\/Bitcoin\/documentation\/Bitcoin"]]},"metadata":{"modules":[{"name":"Swift Bitcoin"}],"roleHeading":"Article","title":"Getting Started","role":"article"},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/bitcoin\/gettingstarted"]}],"sections":[],"schemaVersion":{"minor":3,"major":0,"patch":0},"seeAlsoSections":[{"identifiers":["doc:\/\/Bitcoin\/documentation\/Bitcoin\/Building","doc:\/\/Bitcoin\/documentation\/Bitcoin\/Running"],"anchor":"Essentials","title":"Essentials","generated":true}],"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Bitcoin\/documentation\/Bitcoin\/GettingStarted"},"abstract":[{"text":"Swift Bitcoin let’s you integrate the different capabilities of the Bitcoin protocol into your own product.","type":"text"}],"references":{"doc://Bitcoin/documentation/Bitcoin/Running":{"role":"article","type":"topic","abstract":[{"text":"Start a Bitcoin node service, query it and control it with the command line utility.","type":"text"}],"identifier":"doc:\/\/Bitcoin\/documentation\/Bitcoin\/Running","kind":"article","url":"\/documentation\/bitcoin\/running","title":"Running"},"doc://Bitcoin/documentation/Bitcoin/Building":{"type":"topic","title":"Building","abstract":[{"text":"Build the Swift Bitcoin library and executables using the Swift Toolchain or Docker.","type":"text"}],"role":"article","url":"\/documentation\/bitcoin\/building","kind":"article","identifier":"doc:\/\/Bitcoin\/documentation\/Bitcoin\/Building"},"doc://Bitcoin/documentation/Bitcoin":{"role":"collection","type":"topic","abstract":[{"text":"Pure-Swift Bitcoin client implementation with full node capabilities.","type":"text"}],"identifier":"doc:\/\/Bitcoin\/documentation\/Bitcoin","kind":"symbol","title":"Swift Bitcoin","url":"\/documentation\/bitcoin"}}}